<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LGH Profit Calculator / LGH Vinstbereknare</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="CoolPortals.PNG">
    <link rel="apple-touch-icon" href="CoolPortals.PNG">
    
    <!-- SEO Meta Tags -->
    <meta name="description" content="Ber√§kna vinst vid f√∂rs√§ljning av l√§genhet i Sverige. Gratis vinstkalkylator med skatt, l√•n och alla avdrag.">
    <meta name="keywords" content="l√§genhet, vinst, kalkylator, f√∂rs√§ljning, skatt, Sverige, BRF">
    <meta name="author" content="CoolPortals">
    
    <!-- Open Graph for social sharing -->
    <meta property="og:title" content="Kalkylator f√∂rs√§ljning LGH">
    <meta property="og:description" content="Gratis vinstkalkylator f√∂r bostadsf√∂rs√§ljning i Sverige">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://howcan66.github.io/vinst-p--lgh/">
    <meta property="og:image" content="https://howcan66.github.io/vinst-p--lgh/CoolPortals.PNG">
    
    <!-- Mobile optimization -->
    <meta name="theme-color" content="#000000">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: #000;
            padding: 8px;
            min-height: 100vh;
            color: #fff;
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: white;
            margin-bottom: 4px;
            padding: 12px 16px;
            background: #000;
            border-radius: 8px;
        }

        .header h1 {
            font-size: 12px;
            font-weight: normal;
            margin: 0;
        }

        .header .subtitle {
            display: none;
        }

        .card {
            background: #000;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(255, 255, 255, 0.15);
            margin-bottom: 4px;
            overflow: hidden;
        }

        .card-header {
            display: none;
        }

        .card-body {
            padding: 12px 16px;
        }

        .input-group {
            margin-bottom: 10px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0px;
            align-items: center;
        }

        .input-group.full {
            grid-template-columns: 1fr;
        }

        .input-label {
            font-size: 14px;
            color: #fff;
            font-weight: 700;
            text-align: left;
        }

        .input-field {
            padding: 4px 6px;
            border: 1px solid #fff;
            border-radius: 6px;
            font-size: 14px;
            font-family: inherit;
            background: #fff;
            color: #000;
            height: 24px;
        }

        .input-field:focus {
            outline: none;
            border-color: #fff;
            background: #fff;
        }

        .section-title {
            font-size: 14px;
            font-weight: 700;
            color: #fff;
            margin-top: 12px;
            margin-bottom: 8px;
            letter-spacing: 0.5px;
            text-align: left;
        }

        .output-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
            align-items: center;
            padding: 4px 0;
            border-bottom: 1px solid #333;
        }

        .output-row:last-child {
            border-bottom: none;
        }

        .output-label {
            font-size: 14px;
            color: #fff;
            font-weight: 700;
            text-align: left;
        }

        .output-value {
            text-align: right;
            font-size: 14px;
            font-weight: 700;
            color: #fff;
            font-family: 'Courier New', monospace;
        }

        .language-toggle {
            display: flex;
            gap: 4px;
        }

        .lang-btn {
            padding: 6px 12px;
            margin: 0 2px;
            border: 1px solid #fff;
            background: #000;
            color: #fff;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
        }

        .lang-btn.active {
            background: #fff;
            color: #000;
        }

        .lang-btn:hover {
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .lang-btn[data-tooltip]:hover::before {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            margin-bottom: 5px;
            padding: 4px 8px;
            background: #333;
            color: #fff;
            font-size: 11px;
            border-radius: 4px;
            white-space: nowrap;
            z-index: 1000;
        }

        .lang-btn[data-tooltip]:hover::after {
            content: '';
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            border: 4px solid transparent;
            border-top-color: #333;
            z-index: 1000;
        }

        .icon-btn {
            padding: 6px 8px;
            margin: 0 2px;
            border: 1px solid #fff;
            background: #000;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .icon-btn:hover {
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        /* Print-friendly styling */
        @media print {
            body {
                background: #fff;
                color: #000;
            }
            .header,
            .lang-btn,
            .icon-btn,
            .secret-btn,
            button {
                display: none !important;
            }
            .card {
                box-shadow: none;
                border: 1px solid #000;
            }
            .input-field {
                border: none;
                border-bottom: 1px solid #000;
                background: transparent;
                color: #000;
            }
        }

        .icon-btn img {
            height: 20px;
            width: 20px;
            border-radius: 4px;
        }

        .secret-btn {
            background: #000;
            border: 1px solid #000;
            color: #000;
        }

        .secret-btn:hover {
            color: #fff;
            box-shadow: 0 2px 8px rgba(255, 255, 255, 0.1);
        }

        @media (max-width: 480px) {
            .input-group {
                grid-template-columns: 1fr;
            }

            .input-label {
                font-size: 11px;
            }

            .input-field {
                font-size: 13px;
            }

            .output-row {
                grid-template-columns: 1fr;
                gap: 4px;
            }

            .output-value {
                text-align: left;
            }

            .header h1 {
                font-size: 12px;
                font-weight: normal;
            }
        }
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <div style="display: flex; align-items: center; gap: 8px;">
            <h1 id="title">Kalkylator f√∂rs√§ljning LGH</h1>
        </div>
        <div style="display: flex; align-items: center; gap: 4px;">
            <a href="S13.Passcode.html" target="_blank" class="lang-btn secret-btn" aria-label="Secret access" data-tooltip="Secret">S13</a>
            <button class="lang-btn" id="refresh-btn" onclick="location.reload()" aria-label="Refresh page" data-tooltip="Refresh">üîÑ</button>
            <button class="lang-btn active" data-lang="sv" aria-label="Swedish language" data-tooltip="Swedish">SV</button>
            <button class="lang-btn" data-lang="en" aria-label="English language" data-tooltip="English">EN</button>
            <button class="lang-btn" id="print-btn" aria-label="Print calculations" data-tooltip="Print">üñ®Ô∏è</button>
            <button class="lang-btn" id="email-btn" aria-label="Email results" data-tooltip="Email">‚úâÔ∏è</button>
            <button class="lang-btn" id="clear-btn" aria-label="Clear saved data" data-tooltip="Clear">üóëÔ∏è</button>
        </div>
    </div>

    <!-- Input Card -->
    <div class="card">
        <div class="card-header" id="input-header">Ber√§kningsdata</div>
        <div class="card-body">
            <!-- Sale Price Section -->
            <div class="input-group">
                <label class="input-label" id="label-price">F√∂rs√§ljningspris (kr)</label>
                <input type="text" id="forsaljningspris" class="input-field" value="4350000" inputmode="numeric">
            </div>
            <div class="input-group">
                <label class="input-label" id="label-loan">L√•n (kr)</label>
                <input type="text" id="lan" class="input-field" value="1950000" inputmode="numeric">
            </div>

            <!-- Acquisition Costs Section -->
            <div class="input-group">
                <label class="input-label" id="label-purchase">Ink√∂pspris (kr)</label>
                <input type="text" id="inkopspris" class="input-field" value="380000" inputmode="numeric">
            </div>
            <div class="input-group">
                <label class="input-label" id="label-broker">M√§klararvode (kr)</label>
                <input type="text" id="maklararvode" class="input-field" value="65000" inputmode="numeric">
            </div>
            <div class="input-group">
                <label class="input-label" id="label-styling">Styling (kr)</label>
                <input type="text" id="styling" class="input-field" value="0" inputmode="numeric">
            </div>
            <div class="input-group">
                <label class="input-label" id="label-photo">Fotografering (kr)</label>
                <input type="text" id="fotografering" class="input-field" value="0" inputmode="numeric">
            </div>
            <div class="input-group">
                <label class="input-label" id="label-reno">Renoveringskostnader (kr)</label>
                <input type="text" id="renoveringskostnader" class="input-field" value="200000" inputmode="numeric">
            </div>
            <div class="input-group">
                <label class="input-label" id="label-other">√ñvriga avdragsgilla (kr)</label>
                <input type="text" id="ovriga" class="input-field" value="0" inputmode="numeric">
            </div>
            <div class="input-group" style="margin-bottom: 2px;">
                <label class="input-label" id="label-capital">Kapitaltillskott, from BRF (kr)</label>
                <input type="text" id="kapitaltillskott" class="input-field" value="10000" inputmode="numeric">
            </div>

            <div class="input-group" style="display: none;">
                <label class="input-label" id="label-taxrate">Skattesats (%)</label>
                <input type="text" id="skattesats" class="input-field" value="22" inputmode="numeric">
            </div>
        </div>
    </div>

    <!-- Result Card -->
    <div class="card">
        <div class="card-header" id="result-header">Resultat</div>
        <div class="card-body">
            <div class="output-row">
                <div class="output-label" id="label-calc1">Totalt avdrag (kr)</div>
                <div class="output-value" id="result-calc1">‚Äì</div>
            </div>
            <div class="output-row">
                <div class="output-label" id="label-calc2">Vinst f√∂re skatt (kr)</div>
                <div class="output-value" id="result-calc2">‚Äì</div>
            </div>
            <div class="output-row">
                <div class="output-label" id="label-calc3">Skatt (kr & 22%)</div>
                <div class="output-value" id="result-calc3">‚Äì</div>
            </div>
            <div class="output-row">
                <div class="output-label" id="label-calc4">Nettoresultat efter skatt (kr)</div>
                <div class="output-value" id="result-calc4">‚Äì</div>
            </div>
            <div class="output-row" style="border-top: 2px solid #667eea; padding-top: 12px; margin-top: 8px; font-weight: 700;">
                <div class="output-label" id="label-calc5">Vinst efter avdrag f√∂r l√•n (kr)</div>
                <div class="output-value" id="result-calc5">‚Äì</div>
            </div>
        </div>
    </div>

    <div style="color: white; font-size: 10px; margin-top: 16px; opacity: 0.8; text-align: center;">
        <p><a href="mailto:coolportals@hotmail.com" style="color: white; text-decoration: none;">coolportals@hotmail.com</a> | ¬© 2026 Vinstkalkylator | <span id="footer-left"></span></p>
    </div>
</div>

<script>
    // Language strings
    const translations = {
        sv: {
            title: 'Kalkylator f√∂rs√§ljning LGH',
            inputHeader: 'Ber√§kningsdata',
            resultHeader: 'Resultat',
            refreshLink: 'Uppdatera sidan',
            labelPrice: 'F√∂rs√§ljningspris (kr)',
            labelLoan: 'L√•n (kr)',
            labelPurchase: 'Ink√∂pspris (kr)',
            labelBroker: 'M√§klararvode (kr)',
            labelStyling: 'Styling (kr)',
            labelPhoto: 'Fotografering (kr)',
            labelReno: 'Renoveringskostnader (kr)',
            labelOther: '√ñvriga avdragsgilla (kr)',
            labelCapital: 'Kapitaltillskott, from BRF (kr)',
            labelTaxrate: 'Skattesats (%)',
            labelCalc1: 'Totalt avdrag (kr)',
            labelCalc2: 'Vinst f√∂re skatt (kr)',
            labelCalc3: 'Skatt (kr & 22%)',
            labelCalc4: 'Nettoresultat efter skatt (kr)',
            labelCalc5: 'Vinst efter avdrag f√∂r l√•n (kr)'
        },
        en: {
            title: 'Apartment Sales Profit Calculator',
            inputHeader: 'Calculation Data',
            resultHeader: 'Results',
            refreshLink: 'Refresh page',
            labelPrice: 'Sale Price (SEK)',
            labelLoan: 'Loan (SEK)',
            labelPurchase: 'Purchase Price (SEK)',
            labelBroker: 'Broker Fee (SEK)',
            labelStyling: 'Styling (SEK)',
            labelPhoto: 'Photography (SEK)',
            labelReno: 'Renovation Costs (SEK)',
            labelOther: 'Other Deductible Costs (SEK)',
            labelCapital: 'Capital Contribution, from BRF (SEK)',
            labelTaxrate: 'Tax Rate (%)',
            labelCalc1: 'Total Deductions (SEK)',
            labelCalc2: 'Profit Before Tax (SEK)',
            labelCalc3: 'Tax (SEK & 22%)',
            labelCalc4: 'Net Result After Tax (SEK)',
            labelCalc5: 'Profit After Loan Deduction (SEK)'
        }
    };

    let currentLang = 'sv';

    // Helpers
    function parseNumber(value) {
        return parseFloat(String(value || '').replace(/\s/g, '')) || 0;
    }

    function formatNumber(value) {
        return Number(value || 0).toLocaleString('sv-SE');
    }

    // Format currency (whole kronor)
    function formatSEK(value) {
        return new Intl.NumberFormat('sv-SE', {
            style: 'currency',
            currency: 'SEK',
            maximumFractionDigits: 0
        }).format(value);
    }

    // Get input values
    function getInputs() {
        return {
            forsaljningspris: parseNumber(document.getElementById('forsaljningspris').value),
            lan: parseNumber(document.getElementById('lan').value),
            inkopspris: parseNumber(document.getElementById('inkopspris').value),
            maklararvode: parseNumber(document.getElementById('maklararvode').value),
            styling: parseNumber(document.getElementById('styling').value),
            fotografering: parseNumber(document.getElementById('fotografering').value),
            renoveringskostnader: parseNumber(document.getElementById('renoveringskostnader').value),
            ovriga: parseNumber(document.getElementById('ovriga').value),
            kapitaltillskott: parseNumber(document.getElementById('kapitaltillskott').value),
            skattesats: Math.max(0, Math.min(100, parseNumber(document.getElementById('skattesats').value))) / 100
        };
    }

    // Calculate all values
    function calculate() {
        const inputs = getInputs();

        // calc1: Totalt avdrag = Sum of all acquisition costs + Kapitaltillskott
        const calc1 = inputs.inkopspris + inputs.maklararvode + inputs.styling + 
                      inputs.fotografering + inputs.renoveringskostnader + inputs.ovriga + 
                      inputs.kapitaltillskott;

        // calc2: Vinst f√∂re skatt = F√∂rs√§ljningspris - calc1
        const calc2 = inputs.forsaljningspris - calc1;

        // calc3: Skatt = calc2 * skattesats
        const calc3 = calc2 * inputs.skattesats;

        // calc4: Nettoresultat efter skatt = calc2 - calc3
        const calc4 = calc2 - calc3;

        // calc5: Vinst efter l√•n = calc4 - L√•n
        const calc5 = calc4 - inputs.lan;

        // Update UI
        document.getElementById('result-calc1').textContent = formatSEK(calc1);
        document.getElementById('result-calc2').textContent = formatSEK(calc2);
        document.getElementById('result-calc3').textContent = formatSEK(calc3);
        document.getElementById('result-calc4').textContent = formatSEK(calc4);
        document.getElementById('result-calc5').textContent = formatSEK(calc5);
    }

    // Update language
    function setLanguage(lang) {
        currentLang = lang;
        const t = translations[lang];

        document.getElementById('title').textContent = t.title;
        document.getElementById('input-header').textContent = t.inputHeader;
        document.getElementById('result-header').textContent = t.resultHeader;
        document.getElementById('refresh-btn').textContent = t.refreshLink;
        document.getElementById('label-price').textContent = t.labelPrice;
        document.getElementById('label-loan').textContent = t.labelLoan;
        document.getElementById('label-purchase').textContent = t.labelPurchase;
        document.getElementById('label-broker').textContent = t.labelBroker;
        document.getElementById('label-styling').textContent = t.labelStyling;
        document.getElementById('label-photo').textContent = t.labelPhoto;
        document.getElementById('label-reno').textContent = t.labelReno;
        document.getElementById('label-other').textContent = t.labelOther;
        document.getElementById('label-capital').textContent = t.labelCapital;
        document.getElementById('label-taxrate').textContent = t.labelTaxrate;
        document.getElementById('label-calc1').textContent = t.labelCalc1;
        document.getElementById('label-calc2').textContent = t.labelCalc2;
        document.getElementById('label-calc3').textContent = t.labelCalc3;
        document.getElementById('label-calc4').textContent = t.labelCalc4;
        document.getElementById('label-calc5').textContent = t.labelCalc5;

        // Update button states
        document.querySelectorAll('.lang-btn').forEach(btn => {
            btn.classList.remove('active');
        });
        document.querySelector(`[data-lang="${lang}"]`).classList.add('active');

        // Update timestamp to reflect language change
        updateTimestamp();

        // Recalculate to ensure formatting is correct
        calculate();

        // Persist language choice
        saveData();
    }

    // Event listeners
    document.querySelectorAll('.input-field').forEach(input => {
        input.addEventListener('input', calculate);
    });

    document.querySelectorAll('.lang-btn').forEach(btn => {
        btn.addEventListener('click', () => {
            setLanguage(btn.getAttribute('data-lang'));
        });
    });

    // Print button
    const printBtn = document.getElementById('print-btn');
    if (printBtn) {
        printBtn.addEventListener('click', () => window.print());
    }

    // Email results button
    const emailBtn = document.getElementById('email-btn');
    if (emailBtn) {
        emailBtn.addEventListener('click', () => {
            const inputs = getInputs();
            const body = [
                'LGH Vinstkalkylator',
                '',
                `F√∂rs√§ljningspris: ${formatSEK(inputs.forsaljningspris)}`,
                `L√•n: ${formatSEK(inputs.lan)}`,
                `Ink√∂pspris: ${formatSEK(inputs.inkopspris)}`,
                `M√§klararvode: ${formatSEK(inputs.maklararvode)}`,
                `Styling: ${formatSEK(inputs.styling)}`,
                `Fotografering: ${formatSEK(inputs.fotografering)}`,
                `Renoveringskostnader: ${formatSEK(inputs.renoveringskostnader)}`,
                `√ñvriga avdragsgilla: ${formatSEK(inputs.ovriga)}`,
                `Kapitaltillskott: ${formatSEK(inputs.kapitaltillskott)}`,
                '',
                `Totalt avdrag: ${document.getElementById('result-calc1').textContent}`,
                `Vinst f√∂re skatt: ${document.getElementById('result-calc2').textContent}`,
                `Skatt: ${document.getElementById('result-calc3').textContent}`,
                `Nettoresultat: ${document.getElementById('result-calc4').textContent}`,
                `Vinst efter l√•n: ${document.getElementById('result-calc5').textContent}`,
                '',
                'Ber√§knat med LGH Vinstkalkylator',
                'https://howcan66.github.io/vinst-p--lgh/'
            ].join('\n');

            const subject = 'LGH Vinstkalkylator Resultat';
            window.location.href = `mailto:?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
        });
    }

    // Clear saved data button
    const clearBtn = document.getElementById('clear-btn');
    if (clearBtn) {
        clearBtn.addEventListener('click', () => {
            const ok = confirm(currentLang === 'sv' ? 'Radera sparade data?' : 'Clear saved data?');
            if (ok) {
                localStorage.removeItem('lghCalculatorData');
                location.reload();
            }
        });
    }

    // Set timestamp
    function updateTimestamp() {
        const now = new Date();
        const yy = String(now.getFullYear()).slice(-2);
        const mm = String(now.getMonth() + 1).padStart(2, '0');
        const dd = String(now.getDate()).padStart(2, '0');
        const hh = String(now.getHours()).padStart(2, '0');
        const min = String(now.getMinutes()).padStart(2, '0');
        const timestamp = `${yy}.${mm}.${dd} ${hh}:${min}`;
        const timeLabel = currentLang === 'sv' ? 'Lokal Tid' : 'Local Time';
        document.getElementById('footer-left').textContent = timeLabel + ' ' + timestamp;
    }

    // Initial calculation and timestamp
    // localStorage - Save data
    function saveData() {
        const data = {
            forsaljningspris: document.getElementById('forsaljningspris').value,
            lan: document.getElementById('lan').value,
            inkopspris: document.getElementById('inkopspris').value,
            maklararvode: document.getElementById('maklararvode').value,
            renoveringskostnader: document.getElementById('renoveringskostnader').value,
            kapitaltillskott: document.getElementById('kapitaltillskott').value,
            skattesats: document.getElementById('skattesats').value,
            language: currentLang,
            timestamp: new Date().toISOString()
        };
        try {
            localStorage.setItem('lghCalculatorData', JSON.stringify(data));
        } catch (e) {
            console.error('Could not save data:', e);
        }
    }

    // localStorage - Load data
    function loadData() {
        try {
            const saved = localStorage.getItem('lghCalculatorData');
            if (saved) {
                const data = JSON.parse(saved);
                document.getElementById('forsaljningspris').value = data.forsaljningspris || 4350000;
                document.getElementById('lan').value = data.lan || 1950000;
                document.getElementById('inkopspris').value = data.inkopspris || 380000;
                document.getElementById('maklararvode').value = data.maklararvode || 65000;
                document.getElementById('renoveringskostnader').value = data.renoveringskostnader || 200000;
                document.getElementById('kapitaltillskott').value = data.kapitaltillskott || 10000;
                document.getElementById('skattesats').value = data.skattesats || 22;
                if (data.language && data.language !== currentLang) {
                    setLanguage(data.language);
                }
            }
        } catch (e) {
            console.error('Could not load data:', e);
        }
    }

    // Load saved data on page load
    loadData();

    // Initial calculation and timestamp
    updateTimestamp();
    calculate();

    // Input validation - prevent negative values
    document.querySelectorAll('.input-field').forEach(input => {
        input.addEventListener('input', function(e) {
            // Remove negative sign if typed
            if (this.value.startsWith('-')) {
                this.value = this.value.replace('-', '');
            }
        });
        
        input.addEventListener('focus', function() {
            // Remove formatting for editing
            this.value = String(this.value || '').replace(/\s/g, '');
        });

        input.addEventListener('blur', function() {
            // Ensure value is valid number on blur
            const value = parseNumber(this.value);
            if (isNaN(value) || value < 0) {
                this.value = 0;
                calculate();
            } else {
                // Format with spaces for readability
                this.value = formatNumber(value);
            }
            // Save data after validation
            saveData();
        });
        
        // Auto-save on change
        input.addEventListener('change', saveData);
    });
</script>

</body>
</html>
