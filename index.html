<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LGH Profit Calculator / LGH Vinstbereknare</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="CoolPortals.PNG">
    <link rel="apple-touch-icon" href="CoolPortals.PNG">
    
    <!-- SEO Meta Tags -->
    <meta name="description" content="Beräkna vinst vid försäljning av lägenhet i Sverige. Gratis vinstkalkylator med skatt, lån och alla avdrag.">
    <meta name="keywords" content="lägenhet, vinst, kalkylator, försäljning, skatt, Sverige, BRF">
    <meta name="author" content="CoolPortals">
    
    <!-- Open Graph for social sharing -->
    <meta property="og:title" content="Kalkylator försäljning LGH">
    <meta property="og:description" content="Gratis vinstkalkylator för bostadsförsäljning i Sverige">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://howcan66.github.io/vinst-p--lgh/">
    <meta property="og:image" content="https://howcan66.github.io/vinst-p--lgh/CoolPortals.PNG">
    
    <!-- Mobile optimization -->
    <meta name="theme-color" content="#000000">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: #000;
            padding: 8px;
            min-height: 100vh;
            color: #fff;
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            color: white;
            margin-bottom: 6px;
            padding: 12px 16px;
            background: #000;
            border-radius: 8px;
        }

        .header h1 {
            font-size: 12px;
            font-weight: normal;
            margin: 0;
        }

        .header .subtitle {
            display: none;
        }

        .card {
            background: #000;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(255, 255, 255, 0.15);
            margin-bottom: 4px;
            overflow: hidden;
        }

        .card-header {
            display: none;
        }

        .card-body {
            padding: 12px 16px;
        }

        .input-group {
            margin-bottom: 10px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0px;
            align-items: center;
        }

        .input-group.full {
            grid-template-columns: 1fr;
        }

        .input-label {
            font-size: 14px;
            color: #fff;
            font-weight: 700;
            text-align: left;
        }

        .input-field {
            padding: 4px 6px;
            border: 1px solid #fff;
            border-radius: 6px;
            font-size: 14px;
            font-family: inherit;
            background: #fff;
            color: #000;
            height: 24px;
        }

        .input-field:focus {
            outline: none;
            border-color: #fff;
            background: #fff;
        }

        .section-title {
            font-size: 14px;
            font-weight: 700;
            color: #fff;
            margin-top: 12px;
            margin-bottom: 8px;
            letter-spacing: 0.5px;
            text-align: left;
        }

        .output-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
            align-items: center;
            padding: 4px 0;
            border-bottom: 1px solid #333;
        }

        .output-row:last-child {
            border-bottom: none;
        }

        .output-label {
            font-size: 14px;
            color: #fff;
            font-weight: 700;
            text-align: left;
        }

        .output-value {
            text-align: right;
            font-size: 14px;
            font-weight: 700;
            color: #fff;
            font-family: 'Courier New', monospace;
        }

        .language-toggle {
            display: flex;
            gap: 4px;
        }

        .lang-btn {
            padding: 6px 12px;
            margin: 0 2px;
            border: 1px solid #fff;
            background: #000;
            color: #fff;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .lang-btn.active {
            background: #fff;
            color: #000;
        }

        .lang-btn:hover {
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .icon-btn {
            padding: 6px 8px;
            margin: 0 2px;
            border: 1px solid #fff;
            background: #000;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .icon-btn:hover {
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .icon-btn img {
            height: 20px;
            width: 20px;
            border-radius: 4px;
        }

        .secret-btn {
            background: #000;
            border: 1px solid #000;
            color: #000;
        }

        .secret-btn:hover {
            color: #fff;
            box-shadow: 0 2px 8px rgba(255, 255, 255, 0.1);
        }

        @media (max-width: 480px) {
            .input-group {
                grid-template-columns: 1fr;
            }

            .input-label {
                font-size: 11px;
            }

            .input-field {
                font-size: 13px;
            }

            .output-row {
                grid-template-columns: 1fr;
                gap: 4px;
            }

            .output-value {
                text-align: left;
            }

            .header h1 {
                font-size: 12px;
                font-weight: normal;
            }
        }
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <div style="display: flex; align-items: center; gap: 8px;">
            <h1 id="title">Kalkylator försäljning LGH</h1>
        </div>
        <div style="display: flex; align-items: center; gap: 4px;">
            <a href="S13.Passcode.html" target="_blank" class="lang-btn secret-btn" aria-label="Secret access">S13</a>
            <button class="lang-btn" id="refresh-btn" onclick="location.reload()" aria-label="Refresh page">Refresh</button>
            <button class="lang-btn active" data-lang="sv" aria-label="Swedish language">SV</button>
            <button class="lang-btn" data-lang="en" aria-label="English language">EN</button>
            <a href="mailto:coolportals@hotmail.com" class="icon-btn" aria-label="Email CoolPortals">
                <img src="CoolPortals.PNG" alt="CoolPortals logo">
            </a>
        </div>
    </div>

    <!-- Input Card -->
    <div class="card">
        <div class="card-header" id="input-header">Beräkningsdata</div>
        <div class="card-body">
            <!-- Sale Price Section -->
            <div class="input-group">
                <label class="input-label" id="label-price">Försäljningspris (kr)</label>
                <input type="number" id="forsaljningspris" class="input-field" value="4350000" min="0">
            </div>
            <div class="input-group">
                <label class="input-label" id="label-loan">Lån (kr)</label>
                <input type="number" id="lan" class="input-field" value="1950000" min="0">
            </div>

            <!-- Acquisition Costs Section -->
            <div class="input-group">
                <label class="input-label" id="label-purchase">Inköpspris (kr)</label>
                <input type="number" id="inkopspris" class="input-field" value="380000" min="0">
            </div>
            <div class="input-group">
                <label class="input-label" id="label-broker">Mäklararvode (kr)</label>
                <input type="number" id="maklararvode" class="input-field" value="65000" min="0">
            </div>
            <div class="input-group">
                <label class="input-label" id="label-styling">Styling (kr)</label>
                <input type="number" id="styling" class="input-field" value="0" min="0">
            </div>
            <div class="input-group">
                <label class="input-label" id="label-photo">Fotografering (kr)</label>
                <input type="number" id="fotografering" class="input-field" value="0" min="0">
            </div>
            <div class="input-group">
                <label class="input-label" id="label-reno">Renoveringskostnader (kr)</label>
                <input type="number" id="renoveringskostnader" class="input-field" value="200000" min="0">
            </div>
            <div class="input-group">
                <label class="input-label" id="label-other">Övriga avdragsgilla (kr)</label>
                <input type="number" id="ovriga" class="input-field" value="0" min="0">
            </div>
            <div class="input-group" style="margin-bottom: 2px;">
                <label class="input-label" id="label-capital">Kapitaltillskott, from BRF (kr)</label>
                <input type="number" id="kapitaltillskott" class="input-field" value="10000" min="0">
            </div>

            <div class="input-group" style="display: none;">
                <label class="input-label" id="label-taxrate">Skattesats (%)</label>
                <input type="number" id="skattesats" class="input-field" value="22" min="0" max="100">
            </div>
        </div>
    </div>

    <!-- Result Card -->
    <div class="card">
        <div class="card-header" id="result-header">Resultat</div>
        <div class="card-body">
            <div class="output-row">
                <div class="output-label" id="label-calc1">Totalt avdrag (kr)</div>
                <div class="output-value" id="result-calc1">–</div>
            </div>
            <div class="output-row">
                <div class="output-label" id="label-calc2">Vinst före skatt (kr)</div>
                <div class="output-value" id="result-calc2">–</div>
            </div>
            <div class="output-row">
                <div class="output-label" id="label-calc3">Skatt (kr & 22%)</div>
                <div class="output-value" id="result-calc3">–</div>
            </div>
            <div class="output-row">
                <div class="output-label" id="label-calc4">Nettoresultat efter skatt (kr)</div>
                <div class="output-value" id="result-calc4">–</div>
            </div>
            <div class="output-row" style="border-top: 2px solid #667eea; padding-top: 12px; margin-top: 8px; font-weight: 700;">
                <div class="output-label" id="label-calc5">Vinst efter avdrag för lån (kr)</div>
                <div class="output-value" id="result-calc5">–</div>
            </div>
        </div>
    </div>

    <div style="color: white; font-size: 10px; margin-top: 16px; opacity: 0.8; text-align: center;">
        <p><a href="mailto:coolportals@hotmail.com" style="color: white; text-decoration: none;">coolportals@hotmail.com</a> | © 2026 Vinstkalkylator | <span id="footer-left"></span></p>
    </div>
</div>

<script>
    // Language strings
    const translations = {
        sv: {
            title: 'Kalkylator försäljning LGH',
            inputHeader: 'Beräkningsdata',
            resultHeader: 'Resultat',
            refreshLink: 'Uppdatera sidan',
            labelPrice: 'Försäljningspris (kr)',
            labelLoan: 'Lån (kr)',
            labelPurchase: 'Inköpspris (kr)',
            labelBroker: 'Mäklararvode (kr)',
            labelStyling: 'Styling (kr)',
            labelPhoto: 'Fotografering (kr)',
            labelReno: 'Renoveringskostnader (kr)',
            labelOther: 'Övriga avdragsgilla (kr)',
            labelCapital: 'Kapitaltillskott, from BRF (kr)',
            labelTaxrate: 'Skattesats (%)',
            labelCalc1: 'Totalt avdrag (kr)',
            labelCalc2: 'Vinst före skatt (kr)',
            labelCalc3: 'Skatt (kr & 22%)',
            labelCalc4: 'Nettoresultat efter skatt (kr)',
            labelCalc5: 'Vinst efter avdrag för lån (kr)'
        },
        en: {
            title: 'Apartment Sales Profit Calculator',
            inputHeader: 'Calculation Data',
            resultHeader: 'Results',
            refreshLink: 'Refresh page',
            labelPrice: 'Sale Price (SEK)',
            labelLoan: 'Loan (SEK)',
            labelPurchase: 'Purchase Price (SEK)',
            labelBroker: 'Broker Fee (SEK)',
            labelStyling: 'Styling (SEK)',
            labelPhoto: 'Photography (SEK)',
            labelReno: 'Renovation Costs (SEK)',
            labelOther: 'Other Deductible Costs (SEK)',
            labelCapital: 'Capital Contribution, from BRF (SEK)',
            labelTaxrate: 'Tax Rate (%)',
            labelCalc1: 'Total Deductions (SEK)',
            labelCalc2: 'Profit Before Tax (SEK)',
            labelCalc3: 'Tax (SEK & 22%)',
            labelCalc4: 'Net Result After Tax (SEK)',
            labelCalc5: 'Profit After Loan Deduction (SEK)'
        }
    };

    let currentLang = 'sv';

    // Format currency (whole kronor)
    function formatSEK(value) {
        return new Intl.NumberFormat('sv-SE', {
            style: 'currency',
            currency: 'SEK',
            maximumFractionDigits: 0
        }).format(value);
    }

    // Get input values
    function getInputs() {
        return {
            forsaljningspris: parseFloat(document.getElementById('forsaljningspris').value) || 0,
            lan: parseFloat(document.getElementById('lan').value) || 0,
            inkopspris: parseFloat(document.getElementById('inkopspris').value) || 0,
            maklararvode: parseFloat(document.getElementById('maklararvode').value) || 0,
            styling: parseFloat(document.getElementById('styling').value) || 0,
            fotografering: parseFloat(document.getElementById('fotografering').value) || 0,
            renoveringskostnader: parseFloat(document.getElementById('renoveringskostnader').value) || 0,
            ovriga: parseFloat(document.getElementById('ovriga').value) || 0,
            kapitaltillskott: parseFloat(document.getElementById('kapitaltillskott').value) || 0,
            skattesats: Math.max(0, Math.min(100, parseFloat(document.getElementById('skattesats').value) || 0)) / 100
        };
    }

    // Calculate all values
    function calculate() {
        const inputs = getInputs();

        // calc1: Totalt avdrag = Sum of all acquisition costs + Kapitaltillskott
        const calc1 = inputs.inkopspris + inputs.maklararvode + inputs.styling + 
                      inputs.fotografering + inputs.renoveringskostnader + inputs.ovriga + 
                      inputs.kapitaltillskott;

        // calc2: Vinst före skatt = Försäljningspris - calc1
        const calc2 = inputs.forsaljningspris - calc1;

        // calc3: Skatt = calc2 * skattesats
        const calc3 = calc2 * inputs.skattesats;

        // calc4: Nettoresultat efter skatt = calc2 - calc3
        const calc4 = calc2 - calc3;

        // calc5: Vinst efter lån = calc4 - Lån
        const calc5 = calc4 - inputs.lan;

        // Update UI
        document.getElementById('result-calc1').textContent = formatSEK(calc1);
        document.getElementById('result-calc2').textContent = formatSEK(calc2);
        document.getElementById('result-calc3').textContent = formatSEK(calc3);
        document.getElementById('result-calc4').textContent = formatSEK(calc4);
        document.getElementById('result-calc5').textContent = formatSEK(calc5);
    }

    // Update language
    function setLanguage(lang) {
        currentLang = lang;
        const t = translations[lang];

        document.getElementById('title').textContent = t.title;
        document.getElementById('input-header').textContent = t.inputHeader;
        document.getElementById('result-header').textContent = t.resultHeader;
        document.getElementById('refresh-btn').textContent = t.refreshLink;
        document.getElementById('label-price').textContent = t.labelPrice;
        document.getElementById('label-loan').textContent = t.labelLoan;
        document.getElementById('label-purchase').textContent = t.labelPurchase;
        document.getElementById('label-broker').textContent = t.labelBroker;
        document.getElementById('label-styling').textContent = t.labelStyling;
        document.getElementById('label-photo').textContent = t.labelPhoto;
        document.getElementById('label-reno').textContent = t.labelReno;
        document.getElementById('label-other').textContent = t.labelOther;
        document.getElementById('label-capital').textContent = t.labelCapital;
        document.getElementById('label-taxrate').textContent = t.labelTaxrate;
        document.getElementById('label-calc1').textContent = t.labelCalc1;
        document.getElementById('label-calc2').textContent = t.labelCalc2;
        document.getElementById('label-calc3').textContent = t.labelCalc3;
        document.getElementById('label-calc4').textContent = t.labelCalc4;
        document.getElementById('label-calc5').textContent = t.labelCalc5;

        // Update button states
        document.querySelectorAll('.lang-btn').forEach(btn => {
            btn.classList.remove('active');
        });
        document.querySelector(`[data-lang="${lang}"]`).classList.add('active');

        // Update timestamp to reflect language change
        updateTimestamp();

        // Recalculate to ensure formatting is correct
        calculate();

        // Persist language choice
        saveData();
    }

    // Event listeners
    document.querySelectorAll('.input-field').forEach(input => {
        input.addEventListener('input', calculate);
    });

    document.querySelectorAll('.lang-btn').forEach(btn => {
        btn.addEventListener('click', () => {
            setLanguage(btn.getAttribute('data-lang'));
        });
    });

    // Set timestamp
    function updateTimestamp() {
        const now = new Date();
        const yy = String(now.getFullYear()).slice(-2);
        const mm = String(now.getMonth() + 1).padStart(2, '0');
        const dd = String(now.getDate()).padStart(2, '0');
        const hh = String(now.getHours()).padStart(2, '0');
        const min = String(now.getMinutes()).padStart(2, '0');
        const timestamp = `${yy}.${mm}.${dd} ${hh}:${min}`;
        const timeLabel = currentLang === 'sv' ? 'Lokal Tid' : 'Local Time';
        document.getElementById('footer-left').textContent = timeLabel + ' ' + timestamp;
    }

    // Initial calculation and timestamp
    // localStorage - Save data
    function saveData() {
        const data = {
            forsaljningspris: document.getElementById('forsaljningspris').value,
            lan: document.getElementById('lan').value,
            inkopspris: document.getElementById('inkopspris').value,
            maklararvode: document.getElementById('maklararvode').value,
            renoveringskostnader: document.getElementById('renoveringskostnader').value,
            kapitaltillskott: document.getElementById('kapitaltillskott').value,
            skattesats: document.getElementById('skattesats').value,
            language: currentLang,
            timestamp: new Date().toISOString()
        };
        try {
            localStorage.setItem('lghCalculatorData', JSON.stringify(data));
        } catch (e) {
            console.error('Could not save data:', e);
        }
    }

    // localStorage - Load data
    function loadData() {
        try {
            const saved = localStorage.getItem('lghCalculatorData');
            if (saved) {
                const data = JSON.parse(saved);
                document.getElementById('forsaljningspris').value = data.forsaljningspris || 4350000;
                document.getElementById('lan').value = data.lan || 1950000;
                document.getElementById('inkopspris').value = data.inkopspris || 380000;
                document.getElementById('maklararvode').value = data.maklararvode || 65000;
                document.getElementById('renoveringskostnader').value = data.renoveringskostnader || 200000;
                document.getElementById('kapitaltillskott').value = data.kapitaltillskott || 10000;
                document.getElementById('skattesats').value = data.skattesats || 22;
                if (data.language && data.language !== currentLang) {
                    setLanguage(data.language);
                }
            }
        } catch (e) {
            console.error('Could not load data:', e);
        }
    }

    // Load saved data on page load
    loadData();

    // Initial calculation and timestamp
    updateTimestamp();
    calculate();

    // Input validation - prevent negative values
    document.querySelectorAll('.input-field').forEach(input => {
        input.addEventListener('input', function(e) {
            // Remove negative sign if typed
            if (this.value < 0) {
                this.value = 0;
            }
            // Ensure only numbers and decimal point
            this.value = this.value.replace(/[^0-9.]/g, '');
        });
        
        input.addEventListener('blur', function() {
            // Ensure value is valid number on blur
            const value = parseFloat(this.value);
            if (isNaN(value) || value < 0) {
                this.value = 0;
                calculate();
            }
            // Save data after validation
            saveData();
        });
        
        // Auto-save on change
        input.addEventListener('change', saveData);
    });
</script>

</body>
</html>
